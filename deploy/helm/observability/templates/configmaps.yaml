apiVersion: v1
kind: ConfigMap
metadata:
  name: loki-config
  namespace: {{ include "opscopilot-observability.namespace" . }}
  labels:
    {{- include "opscopilot-observability.labels" . | nindent 4 }}
    app.kubernetes.io/component: loki
data:
  config.yml: |
{{ .Files.Get "files/loki/config.yml" | indent 4 }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: tempo-config
  namespace: {{ include "opscopilot-observability.namespace" . }}
  labels:
    {{- include "opscopilot-observability.labels" . | nindent 4 }}
    app.kubernetes.io/component: tempo
data:
  tempo.yml: |
{{ .Files.Get "files/tempo/tempo.yml" | indent 4 }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: prometheus-config
  namespace: {{ include "opscopilot-observability.namespace" . }}
  labels:
    {{- include "opscopilot-observability.labels" . | nindent 4 }}
    app.kubernetes.io/component: prometheus
data:
  prometheus.yml: |
{{ .Files.Get "files/prometheus/prometheus.yml" | indent 4 }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: otel-collector-config
  namespace: {{ include "opscopilot-observability.namespace" . }}
  labels:
    {{- include "opscopilot-observability.labels" . | nindent 4 }}
    app.kubernetes.io/component: otel-collector
data:
  collector-config.yml: |
{{ .Files.Get "files/otel/collector-config.yml" | indent 4 }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-datasources
  namespace: {{ include "opscopilot-observability.namespace" . }}
  labels:
    {{- include "opscopilot-observability.labels" . | nindent 4 }}
    app.kubernetes.io/component: grafana
data:
  datasources.yml: |
{{ .Files.Get "files/grafana/provisioning/datasources/datasources.yml" | indent 4 }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards-provider
  namespace: {{ include "opscopilot-observability.namespace" . }}
  labels:
    {{- include "opscopilot-observability.labels" . | nindent 4 }}
    app.kubernetes.io/component: grafana
data:
  dashboards.yml: |
{{ .Files.Get "files/grafana/provisioning/dashboards/dashboards.yml" | indent 4 }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards
  namespace: {{ include "opscopilot-observability.namespace" . }}
  labels:
    {{- include "opscopilot-observability.labels" . | nindent 4 }}
    app.kubernetes.io/component: grafana
data:
  opscopilot-overview.json: |
{{ .Files.Get "files/grafana/dashboards/opscopilot-overview.json" | indent 4 }}
  opscopilot-logs-traces.json: |
{{ .Files.Get "files/grafana/dashboards/opscopilot-logs-traces.json" | indent 4 }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: alloy-config
  namespace: {{ include "opscopilot-observability.namespace" . }}
  labels:
    {{- include "opscopilot-observability.labels" . | nindent 4 }}
    app.kubernetes.io/component: alloy
data:
  config.alloy: |
{{ .Files.Get "files/alloy/config.alloy" | indent 4 }}
